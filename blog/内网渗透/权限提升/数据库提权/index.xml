<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>数据库提权 on mrlxl的知识库</title>
    <link>https://yuy0ung.github.io/blog/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8F%90%E6%9D%83/</link>
    <description>Recent content in 数据库提权 on mrlxl的知识库</description>
    <generator>Hugo</generator>
    <language>en-US</language>
    <lastBuildDate>Thu, 11 Dec 2025 00:00:00 +0800</lastBuildDate>
    <atom:link href="https://yuy0ung.github.io/blog/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8F%90%E6%9D%83/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>MySQL提权</title>
      <link>https://yuy0ung.github.io/blog/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8F%90%E6%9D%83/mysql%E6%8F%90%E6%9D%83/</link>
      <pubDate>Thu, 11 Dec 2025 00:00:00 +0800</pubDate>
      <guid>https://yuy0ung.github.io/blog/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8F%90%E6%9D%83/mysql%E6%8F%90%E6%9D%83/</guid>
      <description>&lt;h1 id=&#34;mysql提权&#34;&gt;MySQL提权&lt;/h1&gt;&#xA;&lt;p&gt;mysql的权限提升通常可以两种：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;UDF提权（常用）&lt;/li&gt;&#xA;&lt;li&gt;写文件提权&#xA;&lt;ul&gt;&#xA;&lt;li&gt;启动项提权&lt;/li&gt;&#xA;&lt;li&gt;mof提权&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 id=&#34;一udf提权&#34;&gt;一、UDF提权&lt;/h2&gt;&#xA;&lt;h4 id=&#34;udf&#34;&gt;UDF&lt;/h4&gt;&#xA;&lt;p&gt;全称为user defined function，用户自定义函数&lt;/p&gt;&#xA;&lt;p&gt;用户可以添加自定义的新函数到Mysql中，以达到功能的扩充，调用方式与一般系统自带的函数相同，例如 contact()，user()，version()等函数&lt;/p&gt;&#xA;&lt;h4 id=&#34;udf提权的作用&#34;&gt;UDF提权的作用&lt;/h4&gt;&#xA;&lt;p&gt;渗透过程中，拿下一台低权限的主机shell（尤其是windows）时，有些操作无法进行，而此时本地恰好存在mysql数据库，且mysql是root权限 (windows中mysql一般都是管理员权限)，就可以通过新建管理员用户等操作实现提权即udf提权，也可以称为通过mysql获得管理员权限&lt;/p&gt;&#xA;&lt;h4 id=&#34;动态链接库&#34;&gt;动态链接库&lt;/h4&gt;&#xA;&lt;p&gt;动态链接库：是把程序代码中会使用的函数编译成机器码，保存在.dll文件中。在编译时，不会把函数的机器码复制一份到可执行文件中。编译器只会在.exe的执行文件里，说明所要调用的函数放在哪一个*.dll文件。程序执行使用到这些函数时，操作系统会把dll文件中的函数拿出来给执行文件使用&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;注&lt;/strong&gt;：在linux中对应为so文件&lt;/p&gt;&#xA;&lt;h4 id=&#34;利用条件以及数据库版本问题&#34;&gt;利用条件以及数据库版本问题&lt;/h4&gt;&#xA;&lt;p&gt;获得一个mysql数据库账号（最好是root），拥有insert、delete权限，拥有将xxx.dll写入相对应目录的权限&lt;/p&gt;&#xA;&lt;p&gt;查看版本：&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-mysql&#34; data-lang=&#34;mysql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;查看secure-file-priv是否有目录限制，执行：&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-mysql&#34; data-lang=&#34;mysql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;show&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;global&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;variables&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;like&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;secure%&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;&#xA;&lt;li&gt;当secure_file_priv 的值为 NULL ，表示限制mysqld 不允许导入|导出，无法进行提权&lt;/li&gt;&#xA;&lt;li&gt;当secure_file_priv 的值为 c:/ ，表示限制 mysqld 的导入|导出只能发生在c盘目录下，无法进行提权&lt;/li&gt;&#xA;&lt;li&gt;当 secure_file_priv的值没有具体值时，表示不对 mysqld 的导入|导出做限制，可以提权&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;查看plugin目录是否存在：&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-mysql&#34; data-lang=&#34;mysql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;select&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;@@&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;plugin_dir&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#或&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;show&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;variables&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;like&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;plugin%&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;udf利用的其中一步，是要将我们的xxx.dll文件上传到mysql检索目录中，mysql各版本的检索目录有所不同：&lt;/p&gt;&#xA;&lt;table&gt;&#xA;  &lt;thead&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;th&gt;版本&lt;/th&gt;&#xA;          &lt;th&gt;路径&lt;/th&gt;&#xA;      &lt;/tr&gt;&#xA;  &lt;/thead&gt;&#xA;  &lt;tbody&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;MySQL &amp;lt; 5.0&lt;/td&gt;&#xA;          &lt;td&gt;导出路径随意&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;5.0 &amp;lt;= MySQL &amp;lt; 5.1&lt;/td&gt;&#xA;          &lt;td&gt;需要导出至目标服务器的系统目录（如：C:\windows\system32\）&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;5.1 &amp;lt; MySQL&lt;/td&gt;&#xA;          &lt;td&gt;必须导出到MySQL安装目录下的&lt;code&gt;lib\plugin&lt;/code&gt;目录下（高版本mysql默认不存在&lt;code&gt;lib\plugin&lt;/code&gt;目录，需要自己创建）&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;  &lt;/tbody&gt;&#xA;&lt;/table&gt;&#xA;&lt;p&gt;版本大于5.1的时候，&lt;code&gt;lib\plugin&lt;/code&gt;文件夹的创建方法：&lt;/p&gt;</description>
    </item>
    <item>
      <title>SQL server提权</title>
      <link>https://yuy0ung.github.io/blog/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8F%90%E6%9D%83/sql-server%E6%8F%90%E6%9D%83/</link>
      <pubDate>Thu, 11 Dec 2025 00:00:00 +0800</pubDate>
      <guid>https://yuy0ung.github.io/blog/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8F%90%E6%9D%83/sql-server%E6%8F%90%E6%9D%83/</guid>
      <description>&lt;h1 id=&#34;sql-server提权&#34;&gt;SQL server提权&lt;/h1&gt;&#xA;&lt;p&gt;SQL server，即mssql，是微软开发的一款关系型数据库系统，常出现在windows主机上，而SQL server具有一些常规的打法（主要是用于提权），这里学习并记录&lt;/p&gt;&#xA;&lt;h3 id=&#34;发现sql-server&#34;&gt;发现SQL server&lt;/h3&gt;&#xA;&lt;h4 id=&#34;本地查看&#34;&gt;本地查看&lt;/h4&gt;&#xA;&lt;p&gt;SQL server默认1433端口，所以如果在getshell后发现1433端口处于监听状态，则有可能安装了SQL server&lt;/p&gt;&#xA;&lt;p&gt;如果端口被修改，可以通过查看进程ID来查找SQL server：&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-cmd&#34; data-lang=&#34;cmd&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;tasklist /svc &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; findstr MSSQLSERVER&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;netstat -ano &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; findstr &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;进程ID&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
    </item>
  </channel>
</rss>

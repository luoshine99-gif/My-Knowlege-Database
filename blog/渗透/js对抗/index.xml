<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>js对抗 on mrlxl的知识库</title>
    <link>https://yuy0ung.github.io/blog/%E6%B8%97%E9%80%8F/js%E5%AF%B9%E6%8A%97/</link>
    <description>Recent content in js对抗 on mrlxl的知识库</description>
    <generator>Hugo</generator>
    <language>en-US</language>
    <lastBuildDate>Thu, 11 Dec 2025 00:00:00 +0800</lastBuildDate>
    <atom:link href="https://yuy0ung.github.io/blog/%E6%B8%97%E9%80%8F/js%E5%AF%B9%E6%8A%97/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>JS逆向基础</title>
      <link>https://yuy0ung.github.io/blog/%E6%B8%97%E9%80%8F/js%E5%AF%B9%E6%8A%97/js%E9%80%86%E5%90%91%E5%9F%BA%E7%A1%80/</link>
      <pubDate>Thu, 11 Dec 2025 00:00:00 +0800</pubDate>
      <guid>https://yuy0ung.github.io/blog/%E6%B8%97%E9%80%8F/js%E5%AF%B9%E6%8A%97/js%E9%80%86%E5%90%91%E5%9F%BA%E7%A1%80/</guid>
      <description>&lt;h1 id=&#34;js逆向基础有道翻译js简单分析&#34;&gt;JS逆向基础+有道翻译JS简单分析&lt;/h1&gt;&#xA;&lt;p&gt;由于最近工作中测试相关资产时，发现很多网站，包括小程序等的web端，传输的数据都是经过了加解密的，于是便需要我们对js中的加解密部分进行分析、调试和逆向，并编写hook代码，配合一些工具将我们测试的请求自动加密，将响应自动解密（其实和爬虫非常类似），实现对数据加解密的对抗&lt;/p&gt;&#xA;&lt;h2 id=&#34;前置知识&#34;&gt;前置知识&lt;/h2&gt;&#xA;&lt;h3 id=&#34;js相关&#34;&gt;JS相关&lt;/h3&gt;&#xA;&lt;p&gt;你可能需要先掌握：javascript基础、闭包、面向对象、原型、原型链&lt;/p&gt;&#xA;&lt;p&gt;对这些概念掌握且能看懂js代码即可&lt;/p&gt;&#xA;&lt;h3 id=&#34;数据传输相关&#34;&gt;数据传输相关&lt;/h3&gt;&#xA;&lt;p&gt;加解密、编解码、消息摘要，这些其实就是应用密码学相关知识，了解原理和作用&lt;/p&gt;&#xA;&lt;h3 id=&#34;基础反调试&#34;&gt;基础反调试&lt;/h3&gt;&#xA;&lt;p&gt;这里说的是最简单的一类情况，常体现为禁用F12、禁用右键等，都是CTF入门接触的，直接在浏览器选项中调出开发者工具即可&lt;/p&gt;&#xA;&lt;p&gt;由于调出开发者工具后会占据一部分屏幕导致innerWidth或innerHeight的值变小，这一属性也有可能用于反调试，解决方案就是让开发者工具以单独窗口打开而不是停靠在浏览器页面上&lt;/p&gt;&#xA;&lt;h3 id=&#34;一些开发者工具的功能&#34;&gt;一些开发者工具的功能&lt;/h3&gt;&#xA;&lt;p&gt;很多操作在干渗透的时候都会了，就不多赘述，这里记录一点以前没用过的：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;保留日志/持续记录（一般开启）&lt;/li&gt;&#xA;&lt;li&gt;禁用缓存（一般开启）&lt;/li&gt;&#xA;&lt;li&gt;内容格式化（值得注意的是搜索文件内容最好搜索格式化之前的，格式化可能会补充空格之类的导致搜索不到）&lt;/li&gt;&#xA;&lt;li&gt;Fetch/XHR：js代码中发送的网络请求，比如fetch/ajax&lt;/li&gt;&#xA;&lt;li&gt;文档/HTML：页面加载的第一个html&lt;/li&gt;&#xA;&lt;li&gt;网络：可以看到请求与响应（值得一提的是，在这里无法通过ctrl+f进行搜索请求体内容）&lt;/li&gt;&#xA;&lt;li&gt;调用堆栈：调试界面的功能，当函数运行起来时，调用堆栈可以描述当前运行到的断点处的代码&lt;/li&gt;&#xA;&lt;li&gt;控制台输出：分为错误、告警、信息、日志、调试等几种输出级别&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 id=&#34;基础步骤&#34;&gt;基础步骤&lt;/h2&gt;&#xA;&lt;p&gt;这里以有道翻译的文本翻译功能为例来将基础过一遍，这里先用写爬虫一样的逻辑来走一遍，后面再写关于渗透测试环境中的简单分析&lt;/p&gt;&#xA;&lt;h3 id=&#34;加密逻辑分析&#34;&gt;加密逻辑分析&lt;/h3&gt;&#xA;&lt;p&gt;首先是加密，即我们发送请求时抓包，发现包中的一些数据不是明文，或者相比提交的数据多了一些像签名之类的参数，就需要分析前端加密逻辑&lt;/p&gt;&#xA;&lt;h4 id=&#34;定位数据来源&#34;&gt;定位数据来源&lt;/h4&gt;&#xA;&lt;p&gt;首先需要做的事就是定位我们数据交互时加解密数据的请求包，对于学习了网安的人，相信不论是f12还是burp都是极为简单的，我们可以很轻松定位到指定文本翻译功能的包：&#xA;&lt;img src=&#34;https://yuy0ung.oss-cn-chengdu.aliyuncs.com/image-20250516234211883.png&#34; alt=&#34;image-20250516234211883&#34;&gt;&lt;/p&gt;&#xA;&lt;h4 id=&#34;识别加密参数&#34;&gt;识别加密参数&lt;/h4&gt;&#xA;&lt;p&gt;这里我们先将定位到的请求包复制为curl命令：&lt;/p&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://yuy0ung.oss-cn-chengdu.aliyuncs.com/image-20250517004337192.png&#34; alt=&#34;image-20250517004337192&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;并转换为python request：&lt;/p&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://yuy0ung.oss-cn-chengdu.aliyuncs.com/image-20250517004742406.png&#34; alt=&#34;image-20250517004742406&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;在这里我们可以运行脚本并获得加密后的结果：&lt;/p&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://yuy0ung.oss-cn-chengdu.aliyuncs.com/image-20250517004832447.png&#34; alt=&#34;image-20250517004832447&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;我们分析请求参数:&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;i&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;你好&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;from&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;auto&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;to&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;useTerm&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;false&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;dictResult&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;keyid&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;webfanyi&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;sign&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;68732687ef98f424db7c2c20c30ddb9d&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;client&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;fanyideskweb&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;product&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;webfanyi&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;appVersion&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;1.0.0&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;vendor&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;web&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;pointParam&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;client,mysticTime,product&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;mysticTime&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;1747409777255&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;keyfrom&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;fanyi.web&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;mid&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;1&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;screen&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;1&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;model&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;1&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;network&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;wifi&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;abtest&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;0&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;yduuid&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;abcdefg&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;其实不难看出来一些关键信息：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;i就是我们请求的文本内容明文&lt;/li&gt;&#xA;&lt;li&gt;sign在这里应该是md5这种请求摘要签名，通过更改其他的参数，查看加密的响应可以知道，参数 i 没有参与摘要算法，但时间戳mysticTime参与了（签名一般都是本地js生成）&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h4 id=&#34;定位分析加密算法&#34;&gt;定位分析加密算法&lt;/h4&gt;&#xA;&lt;p&gt;入手点肯定是sign的签名算法，通过全局搜索寻找一下（可以过滤掉无用的文件类型比如css），像下面这样搜索关键字：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;sign&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;sign=&lt;/code&gt;（注意这里不要加等号）&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;sign:&lt;/code&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;\bsign&lt;/code&gt;（需要启用正则表达式，&lt;code&gt;\b&lt;/code&gt;代表匹配字符边界）&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;可以发现很多疑似的代码，我们可以都打上断点进行验证，比如：&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
